<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Gym Log PRO</title>
<style>
:root{
  --bg:#0e0f14; --card:#3a3f5c; --text:#e0e0e0; --sub:#9ca3af; --accent:#10b981; --radius:12px; --gap:10px;
  font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text);padding:16px;}
.app{max-width:420px;margin:0 auto;}
h1{font-size:1.6rem;margin-bottom:1rem;text-align:center;font-weight:700;}
.card{background:var(--card);padding:14px;border-radius:var(--radius);margin-bottom:var(--gap);box-shadow:0 4px 14px rgba(0,0,0,0.4);}
input,button{background:var(--bg);color:var(--text);border:1px solid #555;border-radius:8px;padding:0.5rem;width:100%;font-size:0.95rem;}
input:focus{outline:none;border-color:var(--accent);}
button{cursor:pointer;transition:all 0.15s;}
button:hover{opacity:0.9;}
form .row{display:flex;gap:0.5rem;flex-wrap:wrap;}
form .row > *{flex:1;}
.muscle-section{margin-top:1.5rem;}
.muscle-section h2{text-align:center;font-size:1.2rem;margin-bottom:0.6rem;color:var(--accent);}
.entry-card{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0.75rem;margin-bottom:0.5rem;border-radius:var(--radius);background:var(--bg);box-shadow:0 2px 8px rgba(0,0,0,0.3);}
.entry-card div{flex:1;text-align:center;font-size:0.95rem;}
.entry-card button{flex:0 0 auto;background:none;border:none;color:#ff6f61;font-weight:700;}
@media(max-width:480px){
  .entry-card{flex-direction:column;gap:0.25rem;}
  .entry-card div{width:100%;}
}
</style>
</head>
<body>
<div class="app">
  <h1>Registro de Pesos PRO</h1>

  <div class="card">
    <form id="entryForm">
      <div class="row">
        <input type="text" name="exercise" placeholder="Ejercicio" required>
        <input type="number" name="weight" placeholder="Peso (kg)" step="0.5" required>
      </div>
      <div class="row" style="margin-top:0.5rem;">
        <input type="number" name="reps" placeholder="Reps" value="5" required>
        <input type="date" name="date">
      </div>
      <div style="margin-top:0.75rem;text-align:center;">
        <button type="submit" style="background:var(--accent);color:#fff;">Añadir</button>
        <button type="button" id="exportBtn" style="background:#ff6f61;color:#fff;margin-left:6px;">Exportar CSV</button>
      </div>
    </form>
  </div>

  <div id="entriesArea"></div>
</div>

<script>
const STORAGE_KEY='gym_entries_pro';
let entries=JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]');

const MUSCLE_MAP={
  'Pecho':['Press banca','Aperturas','Fondos'],
  'Espalda':['Dominadas','Remo','Peso muerto'],
  'Piernas':['Sentadilla','Prensa','Zancadas','Curl femoral'],
  'Hombros':['Press militar','Elevaciones laterales','Face pull'],
  'Brazos':['Curl bíceps','Extensión tríceps','Fondos de brazos'],
  'Core':['Plancha','Crunch','Elevación piernas'],
};

function getMuscleGroup(exercise){
  for(const [zone,exs] of Object.entries(MUSCLE_MAP)){
    if(exs.some(e=>e.toLowerCase()===exercise.toLowerCase())) return zone;
  }
  return 'Otros';
}

function formatDate(d){ return new Date(d).toISOString().slice(0,10); }

function saveEntries(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(entries)); }

function renderEntries(){
  const area=document.getElementById('entriesArea');
  area.innerHTML='';
  if(!entries.length){ area.innerHTML='<p style="text-align:center;color:var(--sub);">No hay entradas aún.</p>'; return; }

  const grouped={};
  entries.forEach(e=>{
    const zone=getMuscleGroup(e.exercise);
    if(!grouped[zone]) grouped[zone]=[];
    grouped[zone].push(e);
  });

  for(const [zone,exs] of Object.entries(grouped)){
    const section=document.createElement('div');
    section.className='muscle-section';
    const h2=document.createElement('h2'); h2.textContent=zone;
    section.appendChild(h2);

    exs.slice().reverse().forEach((e,i)=>{
      const row=document.createElement('div');
      row.className='entry-card';
      row.innerHTML=`<div>${e.exercise}</div>
                     <div>${e.weight} kg</div>
                     <div>${e.reps} reps</div>
                     <div>${formatDate(e.date)}</div>
                     <button data-index="${i}" data-zone="${zone}">Borrar</button>`;
      section.appendChild(row);
    });
    area.appendChild(section);
  }

  document.querySelectorAll('.entry-card button').forEach(btn=>{
    btn.addEventListener('click', e=>{
      const idx=parseInt(e.target.dataset.index);
      const zone=e.target.dataset.zone;
      const zoneEntries=entries.filter(x=>getMuscleGroup(x.exercise)===zone);
      const toDelete=zoneEntries[zoneEntries.length-1-idx];
      if(confirm('¿Borrar esta entrada?')){
        entries=entries.filter(x=>x!==toDelete);
        saveEntries();
        renderEntries();
      }
    });
  });
}

document.getElementById('entryForm').addEventListener('submit', e=>{
  e.preventDefault();
  const fd=new FormData(e.target);
  const entry={exercise:fd.get('exercise'), weight:parseFloat(fd.get('weight')), reps:parseInt(fd.get('reps')), date:fd.get('date')||formatDate(new Date())};
  entries.push(entry);
  saveEntries();
  renderEntries();
  e.target.reset();
  e.target.date.value=formatDate(new Date());
});

document.getElementById('exportBtn').addEventListener('click', ()=>{
  let csv='Zona Muscular,Ejercicio,Peso,Reps,Fecha\n';
  entries.forEach(e=>{
    const zone=getMuscleGroup(e.exercise);
    csv+=`${zone},${e.exercise},${e.weight},${e.reps},${formatDate(e.date)}\n`;
  });
  const blob=new Blob([csv],{type:'text/csv;charset=utf-8'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='registro_pesos.csv';
  a.click();
  URL.revokeObjectURL(a.href);
});

renderEntries();
</script>
</body>
</html>
